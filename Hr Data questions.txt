==QUESTION
--1. What is the gender breakdown of employees in the company?
SELECT gender, COUNT(*) AS Count
FROM hr
where termdate is null
GROUP BY gender;

--2. What is the race/ethnicity breakdown of employees in the company
SELECT race, COUNT(*) AS Count
FROM hr
where termdate is null
GROUP BY race
order by count(*) DESC;

--3. What is the age distribution of employees in the company
SELECT
	CASE
		WHEN age >=18 AND age <=24 THEN '18-24'
        WHEN age >=25 AND age <=34 THEN '25-34'
		WHEN age >=35 AND age <=44 THEN '35-44'
		WHEN age >=45 AND age <=60 THEN '45-60'
        ELSE '60+'
	END Age_group,
    COUNT(*)
FROM hr
WHERE termdate is null
GROUP BY Age_group
ORDER BY Age_group;

--4. What is the age distribution by gender of employees in the company
SELECT
	CASE
		WHEN age >=18 AND age <=24 THEN '18-24'
        WHEN age >=25 AND age <=34 THEN '25-34'
		WHEN age >=35 AND age <=44 THEN '35-44'
		WHEN age >=45 AND age <=60 THEN '45-60'
        ELSE '60+'
	END As Age_group, gender,
    COUNT(*)
FROM hr
WHERE termdate is null
GROUP BY Age_group,gender
ORDER BY Age_group,gender;

--5. how many employees work at headquarters versus remote locations
SELECT location, COUNT(*) as COUNT
FROM hr
WHERE termdate is null
GROUP BY  location
;

--6. what is the average lenght of employement for employees who have been teminated
SELECT ROUND(AVG(DATEDIFF(termdate,hire_date)/360),0) as Average_lenght_of_employement
FROM hr
where termdate is not null and termdate <= current_date()
;

--7. How does the gender distribution vary across departments and job titles?
SELECT department,gender,count(*) AS count
FROM hr
WHERE termdate IS NULL
GROUP BY department,gender
ORDER BY department
;

--8.what is the distribution of job titles across the company?
SELECT jobtitle,count(*) as count
FROM hr
WHERE termdate IS NULL
GROUP BY jobtitle
ORDER BY jobtitle desc
;

--9. Wich department has the highest turnover rate?
SELECT Department,
total_count,
terminated_count,
terminated_count/total_count AS turnover_rate
FROM(
select department,
count(*) AS total_count,
SUM(CASE WHEN termdate is NOT null THEN 1 ELSE 0 END) AS terminated_count
FROM hr
GROUP BY department
) AS subquery
order by turnover_rate DESC
;

--10. What is the distribution of employees across locations by city and state?
SELECT location_state, count(*) AS count
FROM hr
WHERE termdate is null
GROUP BY location_state
ORDER BY count DESC;

--11. How has the company's employee count changed over time based on hire and term dates?
 Use project;
 SELECT 
	year,
	hires,
	terminations,
    hires-terminations AS net_change,
    ROUND((hires-terminations)/hires*100,2) AS net_change_percent
FROM(
SELECT 
	YEAR(hire_date) as year,
	count(*) as hires,
	SUM(CASE WHEN termdate IS NOT NULL AND termdate <= CURDATE() THEN 1 ELSE 0 END) AS terminations
	FROM hr
    GROUP BY YEAR(hire_date)
	)  AS subquery
ORDER BY year ASC;

--12. What is the tenure distribution for each department?

    
